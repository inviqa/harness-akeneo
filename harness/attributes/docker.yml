attributes:
  nginx:
    copy_directories:
     - = @('app.web_directory')
     - = @('app.vendor_directory')
     - /app/src/Resources
  services:
    php-base:
      environment:
        AKENEO_SECRET: = @('akeneo.secret')
        AUTOSTART_AKENEO-JOB-QUEUE-CONSUMER: "true"
  pipeline:
    base:
      services:
        php-base:
          environment:
            APP_HOST: = @('pipeline.base.hostname')
            PHP_IDE_CONFIG: = ''
            ES_HOST: = @('pipeline.base.resourcePrefix') ~ 'elasticsearch' ~ ':' ~ ' 9200'
            DB_HOST: = @('pipeline.base.resourcePrefix') ~ 'mysql'
        nginx:
          environment:
            FPM_HOST: = @('pipeline.base.resourcePrefix') ~ 'php-fpm'
        next:
          environment:
            FPM_HOST: = @('pipeline.base.resourcePrefix') ~ 'php-fpm'
    qa:
      services:
        php-base:
          environment:
            APP_HOST: = @('pipeline.qa.hostname')
            ES_HOST: = @('pipeline.qa.resourcePrefix') ~ 'elasticsearch' ~ ':' ~ ' 9200'
            DB_HOST: = @('pipeline.qa.resourcePrefix') ~ 'mysql'
        nginx:
          environment:
            FPM_HOST: = @('pipeline.qa.resourcePrefix') ~ 'php-fpm'
        next:
          environment:
            FPM_HOST: = @('pipeline.qa.resourcePrefix') ~ 'php-fpm'
